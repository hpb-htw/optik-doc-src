\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kt}{vector}\PY{+w}{ }\PY{n}{normalDir}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{+w}{ }\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{k+kt}{point}\PY{+w}{ }\PY{n}{mCenter}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{+w}{ }\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{k+kt}{point}\PY{+w}{ }\PY{n}{source}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{+w}{ }\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{;}
\PY{k+kt}{real}\PY{+w}{ }\PY{n}{reflectedRayLength}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{l+m+mi}{14}\PY{p}{;}

\PY{n}{PlanaMirror}\PY{+w}{ }\PY{n}{m}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{n}{PlanaMirror}\PY{p}{(}\PY{n}{normalDir}\PY{p}{,}\PY{+w}{ }\PY{n}{mCenter}\PY{p}{)}\PY{p}{;}
\PY{k+kt}{point}\PY{+w}{ }\PY{n}{imagePoint}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{n}{m}\PY{p}{.}\PY{n}{imagePoint}\PY{p}{(}\PY{n}{source}\PY{p}{)}\PY{p}{;}
\PY{n}{m}\PY{p}{.}\PY{n}{setupMirrorSize}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{+w}{ }\PY{l+m+mi}{12}\PY{p}{,}\PY{+w}{ }\PY{l+m+mi}{8}\PY{p}{,}\PY{+w}{ }\PY{l+m+mf}{0.125}\PY{n+nv}{mm}\PY{p}{)}
\PY{+w}{ }\PY{p}{.}\PY{n}{drawMirror}\PY{p}{(}\PY{n}{withNormal}\PY{o}{=}\PY{k}{false}\PY{p}{)}\PY{+w}{ }\PY{c}{// we don\PYZsq{}t want to show the default normal line}
\PY{p}{;}
\PY{k+kt}{real}\PY{+w}{ }\PY{n}{angleStep}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{l+m+mf}{12.5}\PY{p}{;}
\PY{k+kt}{int}\PY{+w}{ }\PY{n}{steps}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{l+m+mi}{3}\PY{p}{;}
\PY{k}{for}\PY{p}{(}\PY{k+kt}{int}\PY{+w}{ }\PY{n}{i}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{l+m+mi}{0}\PY{p}{;}\PY{+w}{ }\PY{n}{i}\PY{+w}{ }\PY{o}{\PYZlt{}}\PY{+w}{ }\PY{n}{steps}\PY{p}{;}\PY{+w}{ }\PY{o}{+}\PY{o}{+}\PY{n}{i}\PY{p}{)}\PY{+w}{ }\PY{p}{\PYZob{}}\PY{+w}{ }\PY{c}{// rays from three angles: 0, 15 and 30 downward}
\PY{+w}{    }\PY{k+kt}{real}\PY{+w}{ }\PY{n}{incidentAngle}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{o}{\PYZhy{}}\PY{n}{i}\PY{o}{*}\PY{n}{angleStep}\PY{p}{;}
\PY{+w}{    }\PY{k+kt}{vector}\PY{+w}{ }\PY{n}{iDirection}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{n+nf}{dir}\PY{p}{(}\PY{n}{incidentAngle}\PY{p}{)}\PY{p}{;}
\PY{+w}{    }\PY{n}{NormalLine}\PY{+w}{ }\PY{n}{nl}\PY{+w}{ }\PY{o}{=}\PY{+w}{ }\PY{n}{m}\PY{p}{.}\PY{n}{calculateNormal}\PY{p}{(}\PY{n}{source}\PY{p}{,}\PY{+w}{ }\PY{n}{iDirection}\PY{p}{)}\PY{p}{;}
\PY{+w}{    }\PY{n}{m}\PY{p}{.}\PY{n}{drawIncidentRay}\PY{p}{(}\PY{n}{source}\PY{p}{,}\PY{+w}{ }\PY{n}{nl}\PY{p}{,}\PY{+w}{ }\PY{n}{arrowPosition}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{+w}{     }\PY{p}{.}\PY{n}{drawNormal}\PY{p}{(}\PY{n}{nl}\PY{p}{,}\PY{+w}{ }\PY{n+nf}{length}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
\PY{+w}{     }\PY{p}{.}\PY{n}{drawReflectedRay}\PY{p}{(}\PY{n}{source}\PY{p}{,}\PY{+w}{ }\PY{n}{nl}\PY{p}{,}\PY{+w}{ }\PY{n}{arrowPosition}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{+w}{ }\PY{n}{reflectedRayLength}\PY{p}{)}
\PY{+w}{     }\PY{p}{.}\PY{n}{drawImageSegment}\PY{p}{(}\PY{n}{nl}\PY{p}{,}\PY{+w}{ }\PY{n}{imagePoint}\PY{p}{)}
\PY{+w}{    }\PY{p}{;}
\PY{p}{\PYZcb{}}

\PY{n}{m}\PY{p}{.}\PY{n}{labelMirror}\PY{p}{(}\PY{n+nf}{Label}\PY{p}{(}\PY{l+s}{\PYZdq{}\PYZbs{}tLabel\PYZob{}Sp\PYZcb{}\PYZdq{}}\PY{p}{,}\PY{+w}{ }\PY{n+nf}{align}\PY{o}{=}\PY{n+nv}{SE}\PY{p}{)}\PY{p}{,}\PY{+w}{ }\PY{l+s}{\PYZdq{}\PYZdq{}}\PY{p}{)}\PY{p}{;}
\PY{n+nf}{dot}\PY{p}{(}\PY{n}{source}\PY{p}{)}\PY{p}{;}
\PY{n+nf}{label}\PY{p}{(}\PY{l+s}{\PYZdq{}\PYZdl{}\PYZbs{}pLabel\PYZob{}P\PYZcb{}\PYZdl{}\PYZdq{}}\PY{p}{,}\PY{+w}{  }\PY{n}{source}\PY{p}{,}\PY{+w}{ }\PY{n+nv}{N}\PY{p}{)}\PY{p}{;}
\PY{n+nf}{label}\PY{p}{(}\PY{l+s}{\PYZdq{}\PYZdl{}\PYZbs{}pLabel\PYZob{}P\PYZsq{}\PYZcb{}\PYZdl{}\PYZdq{}}\PY{p}{,}\PY{+w}{ }\PY{n}{imagePoint}\PY{p}{,}\PY{+w}{ }\PY{n+nv}{N}\PY{p}{)}\PY{p}{;}
\PY{n+nf}{label}\PY{p}{(}\PY{l+s}{\PYZdq{}\PYZdl{}\PYZbs{}pLabel\PYZob{}A\PYZcb{}\PYZdl{}\PYZdq{}}\PY{p}{,}\PY{+w}{ }\PY{n}{source}\PY{+w}{ }\PY{o}{\PYZhy{}}\PY{o}{\PYZhy{}}\PY{+w}{ }\PY{n}{imagePoint}\PY{p}{,}\PY{+w}{ }\PY{n+nv}{NW}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
